多表合一-新版	702	DORIS	SUCCEEDED	152363	10000	高星自采多表合一	huyan11	SELECT `time` AS `a_706360973BACD74271CB29DB32A16C8D` , MAX(`orchard_dau`) AS `a_1CDEF47E7598F527F9F35B61C72552C3`  FROM ( select  date, time, sum(if(dau<>0,dau,null)) as dau, sum(if(game_dau<>0,game_dau,null)) as game_dau, sum(if(orchard_dau<>0,orchard_dau,null)) as orchard_dau, sum(if(kangaroo_dau<>0,kangaroo_dau,null)) as kangaroo_dau, sum(if(restaurant_dau<>0,restaurant_dau,null)) as restaurant_dau from ( select   substr(date_time,1,10) as date,   substr(date_time,11) as time,  sum(if(catelog='dau',dau,0)) as dau,  sum(if(catelog='game',dau,0)) as game_dau,  sum(if(catelog='orchard',dau,0)) as orchard_dau,  sum(if(catelog='kangaroo',dau,0)) as kangaroo_dau,  sum(if(catelog='restaurant',dau,0)) as restaurant_dau from  mtdw_doris.app_sdk_group_dau_result_v2 where date_partition = ('2020-09-24') and catelog in ('dau','game','kangaroo','orchard','restaurant') group by date_time  union all  select   ('2020-09-24') as date,  substr(date_time,11) as time,  0 as dau,  0 as game_dau,  0 as orchard_dau,  0 as kangaroo_dau,  0 as restaurant_dau from  mtdw_doris.app_sdk_group_dau_result_v2 where date_partition = substr(date_add('2020-09-24', -1),1,10) and catelog in ('game') group by substr(date_time,11) ) aa group by date,time order by date,time  ) sql_push_down_0_0  WHERE 1=1  GROUP BY  `time`;SELECT `time` AS `a_706360973BACD74271CB29DB32A16C8D` , MAX(`orchard_dau`) AS `a_1CDEF47E7598F527F9F35B61C72552C3`  FROM ( select  date, time, sum(if(dau<>0,dau,null)) as dau, sum(if(game_dau<>0,game_dau,null)) as game_dau, sum(if(orchard_dau<>0,orchard_dau,null)) as orchard_dau, sum(if(kangaroo_dau<>0,kangaroo_dau,null)) as kangaroo_dau, sum(if(restaurant_dau<>0,restaurant_dau,null)) as restaurant_dau from ( select   substr(date_time,1,10) as date,   substr(date_time,11) as time,  sum(if(catelog='dau',dau,0)) as dau,  sum(if(catelog='game',dau,0)) as game_dau,  sum(if(catelog='orchard',dau,0)) as orchard_dau,  sum(if(catelog='kangaroo',dau,0)) as kangaroo_dau,  sum(if(catelog='restaurant',dau,0)) as restaurant_dau from  mtdw_doris.app_sdk_group_dau_result_v2 where date_partition = ('2020-09-17') and catelog in ('dau','game','kangaroo','orchard','restaurant') group by date_time  union all  select   ('2020-09-17') as date,  substr(date_time,11) as time,  0 as dau,  0 as game_dau,  0 as orchard_dau,  0 as kangaroo_dau,  0 as restaurant_dau from  mtdw_doris.app_sdk_group_dau_result_v2 where date_partition = substr(date_add('2020-09-17', -1),1,10) and catelog in ('game') group by substr(date_time,11) ) aa group by date,time order by date,time  ) sql_push_down_0_1  WHERE 1=1  GROUP BY  `time`	query	20200924	12	2020092412
SELECT `time` AS `a_706360973BACD74271CB29DB32A16C8D` , MAX(`orchard_dau`) AS `a_1CDEF47E7598F527F9F35B61C72552C3`  FROM ( select  date, time, sum(if(dau<>0,dau,null)) as dau, sum(if(game_dau<>0,game_dau,null)) as game_dau, sum(if(orchard_dau<>0,orchard_dau,null)) as orchard_dau, sum(if(kangaroo_dau<>0,kangaroo_dau,null)) as kangaroo_dau, sum(if(restaurant_dau<>0,restaurant_dau,null)) as restaurant_dau from ( select   substr(date_time,1,10) as date,   substr(date_time,11) as time,  sum(if(catelog='dau',dau,0)) as dau,  sum(if(catelog='game',dau,0)) as game_dau,  sum(if(catelog='orchard',dau,0)) as orchard_dau,  sum(if(catelog='kangaroo',dau,0)) as kangaroo_dau,  sum(if(catelog='restaurant',dau,0)) as restaurant_dau from  mtdw_doris.app_sdk_group_dau_result_v2 where date_partition = ('2020-09-24') and catelog in ('dau','game','kangaroo','orchard','restaurant') group by date_time  union all  select   ('2020-09-24') as date,  substr(date_time,11) as time,  0 as dau,  0 as game_dau,  0 as orchard_dau,  0 as kangaroo_dau,  0 as restaurant_dau from  mtdw_doris.app_sdk_group_dau_result_v2 where date_partition = substr(date_add('2020-09-24', -1),1,10) and catelog in ('game') group by substr(date_time,11) ) aa group by date,time order by date,time  ) sql_push_down_0_0  WHERE 1=1  GROUP BY  `time`
SELECT `time` AS `a_706360973BACD74271CB29DB32A16C8D` , MAX(`orchard_dau`) AS `a_1CDEF47E7598F527F9F35B61C72552C3`  FROM ( select  date, time, sum(if(dau<>0,dau,null)) as dau, sum(if(game_dau<>0,game_dau,null)) as game_dau, sum(if(orchard_dau<>0,orchard_dau,null)) as orchard_dau, sum(if(kangaroo_dau<>0,kangaroo_dau,null)) as kangaroo_dau, sum(if(restaurant_dau<>0,restaurant_dau,null)) as restaurant_dau from ( select   substr(date_time,1,10) as date,   substr(date_time,11) as time,  sum(if(catelog='dau',dau,0)) as dau,  sum(if(catelog='game',dau,0)) as game_dau,  sum(if(catelog='orchard',dau,0)) as orchard_dau,  sum(if(catelog='kangaroo',dau,0)) as kangaroo_dau,  sum(if(catelog='restaurant',dau,0)) as restaurant_dau from  mtdw_doris.app_sdk_group_dau_result_v2 where date_partition = ('2020-09-17') and catelog in ('dau','game','kangaroo','orchard','restaurant') group by date_time  union all  select   ('2020-09-17') as date,  substr(date_time,11) as time,  0 as dau,  0 as game_dau,  0 as orchard_dau,  0 as kangaroo_dau,  0 as restaurant_dau from  mtdw_doris.app_sdk_group_dau_result_v2 where date_partition = substr(date_add('2020-09-17', -1),1,10) and catelog in ('game') group by substr(date_time,11) ) aa group by date,time order by date,time  ) sql_push_down_0_1  WHERE 1=1  GROUP BY  `time`